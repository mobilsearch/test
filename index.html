<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>동원훈련 소속중대 확인</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f3f4f6;
      color: #333;
    }
    .message-box {
      font-size: 13pt;
      line-height: 1.5;
    }
    .message-box h3 {
      font-weight: bold;
      font-size: 1.5em;
      margin-bottom: 0.5em;
    }
    input[type="radio"]:checked + span {
      font-weight: bold;
      color: #1d4ed8; /* blue-700 */
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen">

  <main class="bg-white p-8 rounded-xl shadow-lg w-full max-w-3xl">
    <section id="form-section">
      <h1 class="text-2xl font-bold mb-1 text-center">동원훈련 소속중대 확인</h1>
      <p class="text-sm text-center mb-6 text-gray-500">(훈련기간: 9.9.(화) ~ 9.11.(목))</p>
      <p class="text-gray-600 mb-6 text-center">성명을 입력하고 소속 중대를 확인하세요.</p>
      <div class="flex flex-col space-y-4">
        <label for="nameInput" class="sr-only">성명 입력</label>
        <input id="nameInput" type="text" placeholder="성명을 입력하세요"
               class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
               aria-label="성명을 입력하세요">
        <button id="searchButton" type="button"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
          중대 검색
        </button>
      </div>
      <!-- ✅ 초기 안내 문구 -->
      <p id="message" class="mt-4 text-black font-bold text-lg text-center" aria-live="polite">
        119여단 2대대
      </p>
    </section>

    <section id="duplicate-section" class="hidden" aria-hidden="true">
      <h2 class="text-xl font-bold mb-4 text-center">동명이인입니다. 본인의 생년월일을 선택하세요.</h2>
      <div id="duplicateList" class="space-y-3 mb-6" role="radiogroup"></div>
      <button id="selectDobButton" type="button"
              class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
        선택 완료
      </button>
    </section>

    <section id="result-section" class="hidden" aria-hidden="true">
      <div class="message-box bg-gray-100 p-6 rounded-lg shadow-inner w-full">
        <p id="finalMessage" class="mb-4 text-lg"></p>
        <div class="border-t border-gray-300 pt-4 mt-4">
          <h3 class="font-bold text-lg mb-2">예비군 안내사항</h3>
          <ol class="list-decimal list-inside space-y-2 text-base">
            <li>문진표를 작성하여 안보교육관으로 이동 바랍니다.</li>
            <li>중대 인도인접 전 개인별 생활관 이동은 금지됩니다.</li>
            <li>금일 인도인접은 12시까지이며, 13시까지 지연입소가 가능합니다.</li>
            <li>인도인접 후 내무실에 도착하면 장구류를 확인 바랍니다.</li>
            <li>금일 오후에는 14시부터 총기를 지급하고, 16시부터 대대장 및 중대장 간담회, 19시부터 안보교육이 진행됩니다.</li>
            <li>궁금한 사항은 교관 및 중대장에게 문의 바랍니다.</li>
            <li>아래 링크에 따라 국방 모바일 보안앱(외부인)을 설치 바랍니다.</li>
          </ol>
          <a href="https://play.google.com/store/apps/details?id=kr.go.mnd.mmsa.vt"
             target="_blank" class="block mt-4 text-blue-600 hover:text-blue-800 underline">
            국방 모바일 보안앱(외부인) 설치 (Android)
          </a>
          <a href="https://apps.apple.com/kr/app/id123456789"
             target="_blank" class="block mt-4 text-blue-600 hover:text-blue-800 underline">
            국방 모바일 보안앱(외부인) 설치 (iOS)
          </a>
        </div>
        <div class="mt-8 text-center">
          <button id="restartButton" type="button"
                  class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
            중대 재검색
          </button>
        </div>
      </div>
    </section>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const reservistData = [
 { name: '일두산', dob: '010101', company: '5중대' },
 { name: '이두산', dob: '010102', company: '6중대' },
 { name: '삼두산', dob: '010103', company: '7중대' },
 { name: '사두산', dob: '010104', company: '8중대' }, 
 { name: '오두산', dob: '010105', company: '본부중대' },
 { name: '육두산', dob: '970106', company: '의무중대' },
 { name: '칠두산', dob: '980107', company: '5중대' },
 { name: '팔두산', dob: '960108', company: '6중대' }, 
 { name: '구두산', dob: '990109', company: '7중대' },
 { name: '십두산', dob: '950110', company: '8중대' },
 { name: '십일산', dob: '010111', company: '본부중대' },
 { name: '십이산', dob: '010112', company: '의무중대' },
 { name: '십삼산', dob: '010113', company: '5중대' },
 { name: '십삼산', dob: '010114', company: '6중대' }, // 동명이인
 { name: '십사산', dob: '010115', company: '7중대' },
 { name: '십오산', dob: '010116', company: '8중대' },
 { name: '십육산', dob: '010117', company: '본부중대' },
 { name: '육두산', dob: '010118', company: '의무중대' }, // 동명이인 
{ name: '칠두산', dob: '010119', company: '5중대' }, // 동명이인 
{ name: '팔두산', dob: '010120', company: '6중대' }, // 동명이인 
{ name: '구두산', dob: '010121', company: '7중대' }, // 동명이인 
{ name: '십두산', dob: '010122', company: '8중대' }, // 동명이인
 ];

      const nameInput = document.getElementById('nameInput');
      const searchButton = document.getElementById('searchButton');
      const message = document.getElementById('message');
      const formSection = document.getElementById('form-section');
      const duplicateSection = document.getElementById('duplicate-section');
      const duplicateList = document.getElementById('duplicateList');
      const selectDobButton = document.getElementById('selectDobButton');
      const resultSection = document.getElementById('result-section');
      const finalMessage = document.getElementById('finalMessage');
      const restartButton = document.getElementById('restartButton');

      // ✅ 로그 기록 함수
      function logSearch(name, dob, result) {
        fetch("https://script.google.com/macros/s/AKfycbwKKE5h6MxNJwu-DUbZdol8KOFBZMHoA7aEe0QgEjaqXr4O621B2K9wU6rRvWmViZ7-/exec", {
          method: "POST",
          body: JSON.stringify({ name, dob, result })
        }).catch(err => console.error("Log error:", err));
      }

      searchButton.addEventListener('click', () => {
        const name = nameInput.value.trim();

        formSection.classList.remove('hidden');
        duplicateSection.classList.add('hidden');
        resultSection.classList.add('hidden');

        if (name === '') {
          message.textContent = '성함을 입력하세요.';
          return;
        }

        const matches = reservistData.filter(reservist => reservist.name === name);

        if (matches.length === 0) {
          message.textContent = '명단에 없습니다. 성명 확인 후 다시 시도하세요.';
          logSearch(name, "", "명단 없음");
        } else if (matches.length === 1) {
          displayResult(matches[0]);
        } else {
          displayDuplicateSelection(matches);
        }
      });

      function displayDuplicateSelection(matches) {
        formSection.classList.add('hidden');
        duplicateSection.classList.remove('hidden');
        duplicateList.innerHTML = '';

        matches.forEach((reservist, index) => {
          const dob = formatDob(reservist.dob);
          const label = document.createElement('label');
          label.className = 'flex items-center space-x-2 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100';
          label.innerHTML = `
            <input type="radio" name="reservistDob" value="${index}" class="form-radio h-5 w-5 text-blue-600 cursor-pointer">
            <span class="text-gray-700">${dob}</span>
          `;
          duplicateList.appendChild(label);
        });
      }

      selectDobButton.addEventListener('click', () => {
        const selectedRadio = document.querySelector('input[name="reservistDob"]:checked');
        if (selectedRadio) {
          const selectedIndex = selectedRadio.value;
          const name = nameInput.value.trim();
          const reservist = reservistData.filter(res => res.name === name)[selectedIndex];
          displayResult(reservist);
        } else {
          message.textContent = '생년월일을 선택해주세요.';
        }
      });

      function displayResult(reservist) {
        const companyName = reservist.company;
        finalMessage.innerHTML = `
          <span class="font-bold">${reservist.name}</span> 예비군은 <span class="font-bold">${companyName}</span>입니다.
        `;
        formSection.classList.add('hidden');
        duplicateSection.classList.add('hidden');
        resultSection.classList.remove('hidden');

        logSearch(reservist.name, reservist.dob, companyName);
      }

      restartButton.addEventListener('click', () => {
        resultSection.classList.add('hidden');
        formSection.classList.remove('hidden');
        nameInput.value = '';
        message.textContent = '119여단 2대대'; // ✅ 초기 안내 문구 복원
      });

 function formatDob(dob) {
  const yy = parseInt(dob.substring(0, 2), 10);
  const yearPrefix = yy <= 24 ? "20" : "19";  // 00~24 → 2000년대, 나머지 → 1900년대
  const year = yearPrefix + dob.substring(0, 2);
  const month = dob.substring(2, 4);
  const day = dob.substring(4, 6);
  return `${year}년 ${month}월 ${day}일`;
}

    });
  </script>
</body>
</html>
